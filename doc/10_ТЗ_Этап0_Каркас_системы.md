# Техническое задание
## Этап 0. Каркас системы

### 1. Общие сведения

#### 1.1. Назначение документа
Документ определяет требования к реализации **Этапа 0 — Каркас системы**: базовой архитектуры серверной и клиентской части, модели данных для пользователей и ролей, механизмов аутентификации, структуры интерфейса и других фундаментальных элементов, необходимых для начала разработки модулей Системы.

Этап 0 создаёт основу, которая не будет меняться в последующих этапах.

#### 1.2. Заказчик и исполнитель
- **Заказчик:** обособленное подразделение, занимающееся разработкой и производством СВЧ-модулей.
- **Исполнитель:** внутренняя команда разработки или привлечённый подрядчик.

#### 1.3. Связь с другими документами
Этап 0 должен учитывать и опираться на:
- «Концепция Новой ИС Подразделения»;
- «Бизнес-процессы новой информационной системы подразделения»;
- Приложение В (Каркас интерфейса);
- Приложение Г (Модель данных users/roles).

---

### 2. Цели и область охвата Этапа 0

#### 2.1. Цели
- Создать единый **серверный каркас** на .NET + PostgreSQL.
- Создать **клиентский каркас** на React + Ant Design.
- Реализовать **App Shell** (Header + Sider + Content) — основу интерфейса всех будущих модулей.
- Реализовать **аутентификацию и базовые роли** (ADMIN, USER).
- Подготовить инфраструктуру проекта: сборка, миграции БД, структура каталогов.
- Обеспечить расширяемость и возможность подключения доменных модулей.

#### 2.2. Входит в объём работ Этапа 0
- Создание структуры backend-приложения (.NET, модульный монолит);
- Подключение PostgreSQL и настройка миграций (EF Core);
- Реализация БД пользователей и ролей;
- Реализация логики аутентификации и авторизации;
- Создание структуры frontend-приложения на React + Ant Design;
- Реализация App Shell;
- Реализация страницы входа (login);
- Базовая авторизация UI по ролям (скрытие пунктов меню);
- Настройка роутинга клиентского приложения;
- Настройка CI/CD (опционально);
- Подготовка документации по запуску.

#### 2.3. Не входит в объём работ Этапа 0
- Функциональность модулей (Requests, Procurement, Customers, Production и др.);
- Бизнес-логика, относящаяся к заявкам, заказам, складу, производству;
- Полный RBAC (только базовый минимум);
- Интеграции с Компонент-2020;
- BPM-интеграции.

Даже для будущих интеграций следует учитывать, что детализированная структура доступов Компонент‑2020 зафиксирована в [Component2020_Access_schema_mermaid.md](../.kilocode/rules/Component2020_Access_schema_mermaid.md).

---

### 3. Требования к архитектуре

#### 3.1. Архитектурный стиль
Система строится как **модульный монолит**:
- единое серверное приложение .NET;
- разделение по слоям: Domain, Application, Infrastructure, Web/API;
- разделение по модулям (Requests, Procurement и т.д.) внутри решения, но единая сборка.

#### 3.2. Серверная часть
- **Стек:** .NET 8 (или актуальная LTS) + C#;
- **Web API:** REST/JSON;
- **Схема слоёв:**
  - Domain — сущности, правила;
  - Application — сервисы, случаи применения;
  - Infrastructure — PostgreSQL, репозитории, миграции;
  - Web/API — контроллеры, DTO.
- Поддержка конфигурации через appsettings.
- Логирование (Serilog или аналог).

#### 3.3. Клиентская часть
- **Стек:** React + TypeScript + Ant Design;
- **SPA через React Router**;
- **App Shell:** Header, Sider, Content;
- Поддержка ролей для отображения меню;
- Использование Ant Design Layout, Menu и других компонентов.

---

### 4. Требования к данным и модели

#### 4.1. Хранилище данных
- БД: PostgreSQL;
- Схема «core» или аналог для данных Этапа 0;
- Использование миграций (EF Core Migrations).

#### 4.2. Основные сущности Этапа 0
- Пользователь (`users`);
- Роль (`roles`);
- Связь пользователь–роль (`user_roles`).

Подробности приведены в Приложении Г.

#### 4.3. Требования к целостности данных
- Уникальность логина;
- Устойчивые идентификаторы (UUID);
- Ссылочная целостность между users/roles/user_roles;
- Поддержка аудита (created_at, updated_at).

---

### 5. Требования к пользовательскому интерфейсу

#### 5.1. Общие принципы UI
- Интерфейс должен соответствовать современным промышленным стандартам (SAP Fiori, Dynamics 365);
- Единый стиль Ant Design;
- Чистый интерфейс, отсутствие перегрузки данными;
- Использование таблиц, карточек, коллапс-панелей по назначению.

#### 5.2. App Shell
App Shell состоит из:
- Header — название системы, логин пользователя, меню профиля, кнопка выхода;
- Sider — меню доменов (Requests, Customers, Procurement, Production, Warehouse, Engineering, Technology);
- Content — область отображения текущего модуля;
- Login page — отдельная страница без Shell.

#### 5.3. Варианты отображения меню
- Полноразмерное меню с названиями;
- Свернутое меню с иконками (collapsible Sider);
- Доступность пунктов меню зависит от роли.

#### 5.4. Макеты и требования к навигации
- Использование React Router для маршрутов;
- Чёткая структура URL (например, /requests, /procurement, /login);
- Переходы без перезагрузки страницы (SPA).

---

### 6. Нефункциональные требования

#### 6.1. Производительность
- Отрисовка Shell не более 1 секунды;
- Login не более 1 секунды.

#### 6.2. Масштабируемость
- Возможность добавления новых модулей без изменения Shell.

#### 6.3. Безопасность
- Хеширование паролей (bcrypt или Argon2);
- Защита API через bearer-токены или cookie-based auth;
- Проверка прав на сервере и клиенте.

#### 6.4. Логирование
- Логирование входа/выхода пользователей;
- Ошибки на сервере и клиенте.

---

### 7. Этапы реализации Этапа 0

#### 7.1. Итерация 1 — Backend каркас
- Создание решения .NET;
- Настройка слоёв;
- Создание моделей users/roles/user_roles;
- Создание миграций;
- Реализация API login/logout;
- Seed данных: ADMIN + USER.

#### 7.2. Итерация 2 — Frontend каркас
- Создание React-проекта;
- Реализация App Shell;
- Реализация Login;
- Подключение к API;
- Ролевая фильтрация меню.

#### 7.3. Итерация 3 — Тестирование и стабилизация
- Перенос на тестовый сервер;
- QA проверка;
- Подготовка документации.

---

### 8. Приложения
- **Приложение В. Каркас интерфейса (Этап 0)**;
- **Приложение Г. Модель данных users/roles (Этап 0)**.

Этап 0 считается завершённым после успешного запуска базовой системы с авторизацией, навигацией и рабочим Shell.
